% !TEX program = xelatex
% !TEX encoding = UTF-8 Unicode

\documentclass[10pt]{beamer}
\usepackage{subfigure}
\usepackage{amssymb, amsmath, amsfonts,verbatim}
\usepackage{tikz, booktabs}
\graphicspath{ {./} }
\usetikzlibrary{matrix,arrows,fit,backgrounds,mindmap,plotmarks,decorations.pathreplacing}

\usepackage{pgfplots}
\pgfplotsset{compat=1.12}
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\tikzset{decoration={name=none},}

\newlength\figureheight
\newlength\figurewidth

\newcommand{\tikzdir}[1]{#1.tikz}
\newcommand{\inputtikz}[1]{\input{\tikzdir{#1}}}

\newcommand{\tI}{\tilde {\mathcal I}}
\newcommand{\tA}{\tilde A}
\newcommand{\ty}{\tilde y}
\newcommand{\tx}{\tilde x}
\newcommand{\tw}{\tilde w}
\newcommand{\tv}{\tilde v}
\newcommand{\tC}{\tilde C}
\newcommand{\tP}{\tilde P}
\newcommand{\Ic}{{\mathcal I^c}}
\newcommand{\J}{{\mathcal J}}
\newcommand{\K}{{\mathcal K}}

\DeclareMathOperator{\pr}{Pr}
\DeclareMathOperator{\Smin}{Smin}
\DeclareMathOperator{\Smid}{Smid}
\DeclareMathOperator{\Smax}{Smax}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Med}{Med}
\DeclareMathOperator{\Max}{Max}
\DeclareMathOperator{\Min}{Min}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\logdet}{log\;det}
\DeclareMathOperator{\argmin}{arg\;min}
\DeclareMathOperator{\argmax}{arg\;max}
\let\Tiny\tiny

\title[Secure Info Fusion]{Secure Information Fusion in Cyber-Physical Systems}
\author[Yilin Mo]{Yilin Mo}
\institute[Tsinghua]{
  Department of Automation\\ Tsinghua University\\
}
\date[Nov 21, 2019]{Nov 21st, 2019 \\ 
  \small Joint Work with Jiaqi Yan, Zishuo Li,\\
  Prof. Fei Hao, Xiaoqiang Ren, Bruno Sinopoli, Joao Hespanha}

\usetheme[subsectionpage=none,block=fill]{metropolis}
\definecolor{thupurple}{RGB}{102,8,116}
\setbeamercolor{title separator}{fg=black!50}
\setbeamercolor{frametitle}{bg=thupurple!70!black}

\begin{document}

\maketitle 

\section{Introduction}

\begin{frame}{Cyber-Physical System}
  \begin{itemize}
  \item Cyber-Physical Systems (CPSs) refer to the embedding of computation, communication and control into physical spaces.
    \begin{center}
      \begin{tikzpicture}[scale=0.45,transform shape,level distance=0cm,
        level 1 concept/.append style={sibling angle=120,minimum size = 3cm},
        ]
        \path [draw=thupurple!50,fill=thupurple!20,thick,rounded corners] (-10,-4.5) rectangle (10,7);
        \node at (-9,6) [anchor=north west] {\Huge Physical Space};
        \path[mindmap,concept color=black,text=white]
        node[concept] {\Huge CPS}
        [clockwise from=330]
        child[concept color=green!50!black] { node[concept](communication) {\huge Comm} }
        child[concept color=red] { node[concept](control) {\huge Control} }
        child[concept color=blue] { node[concept](computation) {\huge Comp} };
      \end{tikzpicture}
    \end{center}
  \item Applications: aerospace, chemical processes, civil infrastructure, energy, manufacturing and transportation. 
  \end{itemize}
\end{frame}

\begin{frame}{Security Threats for the CPS}
  \begin{itemize}
  \item The next generation CPS: Smart Grids, Smart Buildings, Smart Home, Internet of Things, will make extensive use of widespread sensing and networking.
  \item As the CPSs become ``smarter'', they are also more vulnerable to malicious attacks.
  \end{itemize}
  \begin{figure}[ht]
    \centering
    \includegraphics[width=0.6\textwidth]{SmartHome.jpg}
  \end{figure}
\end{frame}

\begin{frame}{Stuxnet}
  \begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{stuxnet.jpg}
  \end{figure}
  Stuxnet is the first discovered malware that spies on and subverts industrial control systems. It was discovered in June 2010. 
\end{frame}

\begin{frame}{Industrial Control Systems}
  \begin{figure}[ht]
    \centering
    \includegraphics[width=0.6\textwidth]{cert.jpg}
  \end{figure}
  In FY 2016, ICS-CERT (Industrial Control Systems Cyber Emergency Response Team) received and responded to 290 incidents as reported by asset owners and industry partners.
\end{frame}

%\begin{frame}{Industrial Control Systems}
%  The scope of incidents encompassed a vast range of threats and observed methods for attempting to gain access to both business and control systems infrastructure, including but not limited to the following:
%  \begin{enumerate}
%  \item  Unauthorized access and exploitation of Internet facing ICS/Supervisory Control and Data Acquisition (SCADA) devices,
%  \item  Exploitation of zero-day vulnerabilities in control system devices and software, 
%  \item  Malware infections within air-gapped control system networks,
%  \item \dots
%  \end{enumerate}
%
%\end{frame}

\begin{frame}{Attack Through Compromised Supply Chain}
  \begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{boeing.jpg}
    \caption{Boeing 787 outsourced 70\% of its parts.}
  \end{figure}
\end{frame}

\begin{frame}{2015 Ukraine Power Outage}
  \begin{figure}[<+htpb+>]
    \begin{center}
      \includegraphics[width=0.60\textwidth]{ukraine.jpg}
      \caption{A successful attack on CPS can have devastating effects.}
    \end{center}
  \end{figure}
\end{frame}

%\begin{frame}{What is New in CPS Security?}
%  Why not just use information security?
%  \begin{enumerate}
%  \item Physics
%  \item Physical Attacks: GPS Spoofing, etc.
%  \item Zero-day Attacks: Attack that exploits undiscovered vulnerabilities.
%  \item Cost: Securing every single device is difficult and costly
%  \item High reliability requirement
%  \end{enumerate}
%\end{frame}
%
%\begin{frame}{Defense in Depth}
%  \begin{figure}[<+htpb+>]
%    \begin{center}
%      \includegraphics[width=0.8\textwidth]{defense_in_depth.jpg}
%      \caption{Combining System Theory and Information Security to create better Protection for CPS}
%    \end{center}
%  \end{figure}
%\end{frame}

\begin{frame}{Hardening CPS Security using System Theory}
  \begin{itemize}
  \item System and Attack Modelling
  \item Intrusion Detection and Isolation
  \item Resilient Algorithm Design
  \item Fundamental Limitations
  \item Security System Design and Investment
  \item \dots
  \end{itemize}
\end{frame}

\section{Hypothesis Testing}

\begin{frame}{Static Detection Problem}
  \begin{itemize}
    \item We want to decide whether a binary state $\theta$ is $0$ or $1$.
    \item $m$ identical sensors are measuring the state: 
      \begin{center}
	\setlength{\figureheight}{3cm}
	\setlength{\figurewidth}{10cm}
	\inputtikz{gaussian}
      \end{center}
    \item The ``true'' measurements $z_i$ are independent and identically distributed.
  \end{itemize}
\end{frame}

\begin{frame}{Naive Bayes Detector}
  \begin{itemize}
    \item A detector is a function $f:\mathbb R^m\rightarrow \{-1,1\}$.
    \item The optimal detector (without attacks) with minimum detection error is a Naive Bayesian Detector:
      \begin{align*}
	\hat \theta=f(z)=\begin{cases}
	  -1 &\text{if }\sum_{i}z_i < 0\\
	  +1 &\text{if }\sum_{i}z_i \geq 0\\
	\end{cases}
      \end{align*}
    \item One corrupted measurement will possibly change the detection result. 
  \end{itemize}
\end{frame}

\begin{frame}{Byzantine Attack Model}
  \begin{itemize}
  \item The attacker can compromised $p$ sensors, the set of which is denoted as $\mathcal I$. 
    \begin{displaymath}
      y = z + a,  
    \end{displaymath}
    where $a_i = 0$ if $i\notin \mathcal I$.
    \begin{center}
      \setlength{\figureheight}{2cm}
      \setlength{\figurewidth}{10cm}
      \inputtikz{blockdiagram}
    \end{center}
  \item Assume that $p$ is less than half of $m$.
  \item The detector knows $p$, but does not know $\mathcal I$.
  \end{itemize}
\end{frame}
%
%\begin{frame}{Attack Model}
%  We assume the attacker knows the following:
%  \begin{itemize}
%    \item the detection algorithm $f$ (Kerckhoffs' Principle);
%    \item the true state $\theta$;
%    \item all measurements $z$.
%  \end{itemize}
%  The attacker can manipulate up to $p$ measurements arbitrarily.
%  \begin{displaymath}
%    z = y +  a, 
%  \end{displaymath}
%  where $a$ is $p$-sparse.
%
%  The attacker wants to maximize the probability of error:
%  \begin{displaymath}
%    P_e =\max_{\gamma\in S_\gamma,y^a} P(f(y^c)\neq x).
%  \end{displaymath}
%\end{frame}

%\begin{frame}{Attacker's Strategy}
%  The optimal strategy for the attacker:
%  \begin{align*}
%    (\gamma,y^a)= \begin{cases}
%      \displaystyle argmin_{\gamma\in S_\gamma, y^a} f(y+\gamma\circ y^a ) & (x =1)\\
%      \displaystyle argmax_{\gamma\in S_\gamma,y^a} f(y+ \gamma\circ y^a) & (x =-1)
%    \end{cases}
%  \end{align*}
%  \begin{figure}[<+htpb+>]
%    \centering
%    \subfigure[$x = -1$]{
%    \begin{tikzpicture}
%      \fill[red!20] (1.9,1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \fill[green!20] (-1.9,-1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \node at (1.9,1.9) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.9)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-2)--(0,2) node [anchor = west]{$y_2$};
%      \draw[thick,dashed] (-1,-1)--(-1,1.5);
%      \filldraw  (-1,-1) circle (2pt) node [anchor=east]{$y$};
%      \filldraw  (-1,1.5) circle (2pt) node [anchor=west]{$y^c$};
%    \end{tikzpicture}
%    }
%    \subfigure[$x = 1$]{
%    \begin{tikzpicture}
%      \fill[red!20] (1.9,1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \fill[green!20] (-1.9,-1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \node at (1.9,1.9) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.9)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-2)--(0,2) node [anchor = west]{$y_2$};
%      \filldraw  (-1,-1) circle (2pt) node [anchor=south]{$y=y^c$};
%    \end{tikzpicture}
%    }
%  \end{figure}
%\end{frame}
%
%\begin{frame}{Partitioning the Space of Measurements}
%  \begin{figure}[<+htpb+>]
%    \centering
%    \subfigure[First Detector $f_1$]{
%    \begin{tikzpicture}
%      \fill[red!20] (1.9,1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \fill[green!20] (-1.9,-1.9)--(1.9,-1.9)--(-1.9,1.9);
%      \node at (1.9,1.9) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.9)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-2)--(0,2) node [anchor =north west]{$y_2$};
%      \filldraw  (-0.3,-0.3) circle (2pt) node [anchor=east]{};
%      \draw[dashed,thick] (-2,-0.3)--(2,-0.3);
%      \draw[dashed,thick] (-0.3,-2)--(-0.3,2);
%    \end{tikzpicture}
%    }
%    \subfigure[Second Detector $f_2$]{
%    \begin{tikzpicture}
%      \fill[green!20] (-1.9,-1.9)--(1.9,-1.9)--(1.9,1.9)--(-1.9,1.9);
%      \fill[red!20] (1.9,1.9)--(1.9,0)--(0,0)--(0,1.9);
%      \node at (1.9,1.9) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.9)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-2)--(0,2) node [anchor =north west]{$y_2$};
%      \filldraw  (-0.3,-0.3) circle (2pt) node [anchor=east]{};
%      \draw[dashed,thick] (-2,-0.3)--(2,-0.3);
%      \draw[dashed,thick] (-0.3,-2)--(-0.3,2);
%    \end{tikzpicture}
%    }
%  \end{figure}
%  There are three categories of point in $R^m$:
%  \begin{enumerate}
%    \item for some $\gamma\in S_\gamma,y^a$, $f(y+\gamma\circ y^a)=1$ and for some $\gamma\in S_\gamma,y^a$, $f(y+\gamma\circ y^a)=-1$. (Bad)
%    \item for all $\gamma\in S_\gamma,y^a$, $f(y+\gamma\circ y^a)=-1$. (\alert{Good})
%    \item for all $\gamma\in S_\gamma,y^a$, $f(y+\gamma\circ y^a)=1$. (\alert{Good})
%  \end{enumerate}
%\end{frame}
%
%\begin{frame}{Worst-Case Probability of Error}
%  Define
%  \begin{align*}
%    Y^-(f) &\triangleq \big\{y\in \mathbb R^m:f(y+\gamma\circ y^a)=-1, \; \forall y^a\in\mathbb R^m,\gamma\in S_\gamma\big\},\\
%    Y^+(f) &\triangleq \big\{y\in \mathbb R^m: f(y+\gamma\circ y^a)=1,\; \forall y^a\in\mathbb R^m,\gamma\in S_\gamma\big\}.
%  \end{align*}
%  The detector can correctly detect $x$ if and only if 
%  \begin{displaymath}
%    (x,y)\in\Big\{ (-1,y): y\in Y^-(f) \Big\} \cup \Big\{ (+1,y): y\in Y^+(f) \Big\}
%  \end{displaymath}
%  As a result, the worst-case probability of error is
%  \begin{displaymath}
%    P_e(f) = (1-\mu(Y^+(f)))p^+ +(1-\nu(Y^-(f)) p^-.
%  \end{displaymath}
%  If $Y^-(f)\subseteq Y^-(g)$ and $Y^+(f)\subseteq Y^+(g)$, then $P_e(f)\geq P_e(g)$.
%\end{frame}
%
%\begin{frame}{$Y^-$ and $Y^+$ for different detectors}
%  \begin{figure}[<+htpb+>]
%    \centering
%    \subfigure[First Detector]{
%    \begin{tikzpicture}
%      \fill[red!20] (1.9,1.2)--(1.9,-1.2)--(-1.9,1.2);
%      \fill[green!20] (-1.9,-1.2)--(1.9,-1.2)--(-1.9,1.2);
%      \node at (1.9,1.3) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.3)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-1.3)--(0,1.3) node [anchor =north west]{$y_2$};
%    \end{tikzpicture}
%    }
%    \subfigure[$Y^+$ and $Y^-$]{
%    \begin{tikzpicture}
%      \node at (1.9,1.3) [anchor = north east] {$Y^+ = \emptyset$};
%      \node at (-1.9,-1.3)[anchor = south west] {$Y^- = \emptyset$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-1.3)--(0,1.3) node [anchor =north east]{$y_2$};
%    \end{tikzpicture}
%    }\\
%    \subfigure[Second Detector]{
%    \begin{tikzpicture}
%      \fill[green!20] (-1.9,-1.2)--(1.9,-1.2)--(1.9,1.2)--(-1.9,1.2);
%      \fill[red!20] (1.9,1.2)--(1.9,0)--(0,0)--(0,1.2);
%      \node at (1.9,1.2) [anchor = north east] {$\hat x = 1$};
%      \node at (-1.9,-1.2)[anchor = south west] {$\hat x = -1$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-1.3)--(0,1.3) node [anchor =north west]{$y_2$};
%    \end{tikzpicture}
%    }
%    \subfigure[$Y^+$ and $Y^-$]{
%    \begin{tikzpicture}
%      \fill[green!80] (-1.9,-1.2)--(0,-1.2)--(0,0)--(-1.9,0);
%      \node at (1.9,1.2) [anchor = north east] {$Y^+ = \emptyset$};
%      \node at (-1.9,-1.2)[anchor = south west] {$Y^-$};
%      \draw[->,thick] (-2,0)--(2,0) node [anchor = north]{$y_1$};
%      \draw[->,thick] (0,-1.3)--(0,1.3) node [anchor =north east]{$y_2$};
%    \end{tikzpicture}
%    }
%  \end{figure}
%\end{frame}

\begin{frame}{A Hamming-like distance}
  Define metric $d:\mathbb R^m\times \mathbb R^m\rightarrow \mathbb N_0$ as
  \begin{displaymath}
    d(y_1,y_2)=\|y_1-y_2\|_0. 
  \end{displaymath}
  Let $Y_1,Y_2$ be two subsets of $\mathbb R^m$, define
  \begin{displaymath}
    d(Y_1,Y_2) = \min_{y_1\in Y_1,y_2\in Y_2}d(y_1,y_2),\,d(y,Y) =  \min_{y'\in Y}d(y,y').
  \end{displaymath}

%  \begin{lemma}
%    For any detector $f$, $d(Y^-(f),Y^+(f))\geq 2l+1$.
%  \end{lemma}
%  \begin{lemma}
%    Given $X^-,\,X^+$ two subsets of $\mathbb R^m$, and $d(X^-,X^+)\geq 2l+1$, there exists a detector $f$, such that $X^-\subseteq Y^-(f)$ and $X^+\subseteq Y^+(f)$.
%  \end{lemma}
\end{frame}

\begin{frame}{The structure of the optimal detector}
  \begin{theorem}
    The optimal $f^*$ is of the following form\footnote{Yilin Mo, Joao Hespanha and Bruno Sinopoli, Resilient Detection in the Presence of Integrity Attacks, IEEE Transactions on Signal Processing, Jan 2014, Volume 62, Issue 1, Pages 31-43 }:
    \begin{align*}
      f^*(y) = \begin{cases}
	1 & d(y,X^-)\ge d(y,X^+)\\
	-1 & d(y,X^-)< d(y,X^+),
      \end{cases}
    \end{align*}
    where $X^{+}$ and $X^{-}$ satisfies $d(X^+,X^-)\geq 2l+1$.
%    where $X^{+}$ and $X^{-}$  are the solutions of the following optimization problem:
%    \begin{align*}
%      &\mathop{\textrm{minimize}}\limits_{X^+,X^-}&
%      & (1-\nu(X^-))p^-+(1-\mu(X^+))p^+\\
%      &\textrm{subject to}&
%      & d(X^-,\,X^+)\geq 2l+1
%    \end{align*}
  \end{theorem}
\end{frame}

\begin{frame}{The structure of the optimal detector}
  \begin{figure}[<+htpb+>]
    \begin{center}
      \begin{tikzpicture}
	\draw (0,0) ellipse (3 and 2);
	\node at (0,-2) [anchor = south] {$\mathbb R^m$};
	\node (xplus) at (-2,0) [circle,fill = green!90,draw] {$X^-$};
	\node (xminus) at (2,0) [circle,fill = red!90,draw] {$X^+$}
	edge [stealth-stealth,thick] node[auto] {$\geq 2l+1$} (xplus);
	\filldraw  (-1,1) circle (2pt) node [anchor=south]{$y$};
	\draw [-stealth,thick] (-1,1)--(xplus);
	\draw [-stealth,thick] (-1,1)--(xminus);
      \end{tikzpicture}
    \end{center}
  \end{figure}
  \begin{itemize}
    \item Directly working on the probability of error is hard.
    \item The exact optimal detection is very hard to compute in general.
  \end{itemize}
\end{frame}
%
%\begin{frame}{Optimal Detector for $m \leq 2l$ and $m = 2l+1$}
%  \begin{itemize}
%    \item If $m \leq 2l$, then the optimal detector is $f=1$ oare the solutions of the following optimization problem:r $f = -1$.
%    \item If $ m = 2l+1$, the optimal detector is based on voting:
%      \begin{enumerate}
%	\item The detector computes $m$ individual estimates $\hat x_i$ by a N-P detector based on individual measurements $y_i^c$:
%	  \begin{align*}
%	    \hat x_i \triangleq \begin{cases}
%	      -1 & \Lambda_{i}(y_i^c) <\eta_i\\
%	      1 & \Lambda_{i}(y_i^c) \geq\eta_i\\
%	    \end{cases}.
%	  \end{align*}
%	\item The detector decides $\hat x = 1$ if there are more than half of the $\hat x_i = 1$. Otherwise it decides $\hat x = -1$.
%      \end{enumerate}
%  \end{itemize}
%\end{frame}

\begin{frame}{Sequential Hypothesis Testing Problem}
  \begin{itemize}
    \item Let us define 
      \begin{displaymath}
	z(k) = \begin{bmatrix}z_1(k)&\dots&z_m(k)\end{bmatrix},\,Z(k) = \begin{bmatrix}z(1)&\dots&z(k)\end{bmatrix}.
      \end{displaymath}
    \item A detection strategy is an infinite sequence of detectors $f = (f_1,\,f_2,\,\dots)$, where each $f_k$ maps $Z(k)$ into a decison $\hat \theta(k)$.
    \end{itemize}
  \end{frame}

%\begin{frame}{A Classical Hypothesis Testing Problem}
% \begin{itemize}
%  \item Without the attacker, the optimal detector is a Naive Bayes Detector:
%    \begin{align*}
%      \hat \theta(k)=f_k(Z(k))=\begin{cases}
%        -1 &\text{if }\sum_{i=1}^m\sum_{t=1}^k z_i(t)/mk < 0\\
%        +1 &\text{if }\sum_{i=1}^m\sum_{t=1}^k z_i(t)/mk \geq 0\\
%      \end{cases}.
%    \end{align*}
%  \item However, it is not secure. 
%  \end{itemize}   
%\end{frame}

\begin{frame}{Performance: Probability of Error}
  \begin{itemize}
  \item The probability of error at time $k$ is denoted as
    \begin{displaymath}
      P_e(k) = \max_{\mathcal I,\theta}\; P(f_k(Y(k)) \neq \theta). 
    \end{displaymath}
  \item Clearly, $P_e(k)$ is a function of the detection strategy $f$ and the attack strategy $g$.
  \item  In general, for a fixed $k$, optimizing $P_e(k)$ directly (either from the system's perspective or the attacker's perspective) is difficult.
  \item As a result, we will focus on the asymptotic performance when $k\rightarrow\infty$.
  \end{itemize}
\end{frame}

\begin{frame}{Chernoff Information}
  \begin{itemize}
  \item Suppose we have a single benign sensor, the Naive Bayes Detector takes the following form:
    \begin{align*}
      \hat \theta(k)=f_k(Z(k))=\begin{cases}
        -1 &\text{if }\sum_{t=1}^k z_1(t)/k < 0\\
        +1 &\text{if }\sum_{t=1}^k z_1(t)/k \geq 0\\
      \end{cases}.
    \end{align*}
  \item By LLN, the probability of error goes to $0$.
  \item Moreover, it goes to $0$ exponentially fast, i.e.,
    \begin{displaymath}
      \lim_{k\rightarrow\infty}-\frac{\log P_e(k)}{k}= \frac{1}{2}.
    \end{displaymath}
  \item For multiple benign sensors, the probability of error for the Naive Bayes Detector satisfies:
    \begin{displaymath}
      P_e(k)\approx e^{-\frac{1}{2}mk}.
    \end{displaymath}
  \item For general pair of distributions, one can prove that $P_e \approx e^{-mCk}$, where $C$ is the Chernoff information between the two distributions.
  \end{itemize}
\end{frame}

\begin{frame}{Asymptotic Performance}
  \begin{itemize}
  \item In adversarial environment, let us define the rate function $I$ as
    \begin{displaymath}
      I = \liminf_{k\rightarrow\infty} -\frac{\log P_e(k)}{k}.
    \end{displaymath}
    Roughly speaking, 
    \begin{displaymath}
      P_e(k)\sim e^{-Ik}. 
    \end{displaymath}
    Larger rate implies better detection performance.
  \item  $I$ is a function of both detection strategy $f$ and attack strategy $g$.
  \item The detector wants to maximize $I$ while the attacker wants to minimize $I$.
  \end{itemize}
\end{frame}

\begin{frame}{``Optimal'' Attack Strategy $g^*$}
  \begin{itemize}
  \item Consider the attack, where the adversary simply flips the distribution of $p$ compromised sensors' measurements
    \begin{center}
      \inputtikz{attack}
    \end{center}
  \item The first $2p$ sensors have identical distribution.
  \item The only way to distinguish the two cases is to use the remaining $m-2p$ sensors.
  \item No detector can achieve a performance better than $(m-2p)C$ (Even if they know the adversary's strategy).
  \end{itemize}
\end{frame}

\begin{frame}{``Optimal'' Detection Strategy $f^*$}
  We need to define the following trimmed sum functions:
  \begin{definition}
    Define the symmetric functions $\Smin_{2p},\,\Smid_{2p},\,\Smax_{2p}:\mathbb R^{m}\rightarrow \mathbb R$ as  
    \begin{align*}
      \Smin_{2p}(y_1,\ldots,y_m) &\triangleq \sum_{i=1}^{m-2p}y_i,\\
      \Smid_{2p}(y_1,\ldots,y_m) &\triangleq \sum_{i=p+1}^{m-p}y_i,\\
      \Smax_{2p}(y_1,\ldots,y_m) &\triangleq \sum_{i=2p+1}^{m}y_i,
    \end{align*}
    when $y_1\leq \dots\leq y_m$.
  \end{definition}
\end{frame}

\begin{frame}{``Optimal'' Detection Strategy $f^*$}
  \begin{itemize}
  \item If $\|y - z\|_0\leq p$, then
    \begin{displaymath}
      \Smin_{2p}(z) \leq \Smid_{2p}(y)\leq \Smax_{2p}(z).
    \end{displaymath} 
  \item Assuming $m=5$, $p = 1$:
    \begin{center}
      \begin{tikzpicture}[semithick,>=latex]
        \draw [->] (0,0)--(10,0);
        \draw plot[mark=x] coordinates{(1,0)} node [above] {$z_1$};
        \draw plot[mark=x] coordinates{(2,0)} node [above] {$z_2$};
        \draw plot[mark=x] coordinates{(4,0)} node [above] {$z_3$};
        \draw plot[mark=x] coordinates{(5,0)} node [above] {$z_4$};
        \draw plot[mark=x] coordinates{(7,0)} node [above] {$z_5$};
        
        \draw [->] (0,-2)--(10,-2);
        \draw plot[mark=x] coordinates{(9,-2)} node [above] {$y_1$};
        \draw plot[mark=x] coordinates{(2,-2)} node [above] {$y_2$};
        \draw plot[mark=x] coordinates{(4,-2)} node [above] {$y_3$};
        \draw plot[mark=x] coordinates{(5,-2)} node [above] {$y_4$};
        \draw plot[mark=x] coordinates{(7,-2)} node [above] {$y_5$};
        
        \draw [->,dashed] (1,0)--(1,-1)--(9,-1)--(9,-2);
        \begin{pgfonlayer}{background}
          \fill [fill=red!30] (3,-2.5) rectangle (8,-1.25);
          \node at (5.5,-2.3) {$\Smid_2(y)$};
          
          \fill [fill=blue!30] (3,-0.5) rectangle (8,0.75);
          \node at (5.5,-0.3) {$\Smax_2(z)$};
        \end{pgfonlayer}
      \end{tikzpicture}
    \end{center}
  \item $\Smid_{2p}$ is a more ``secure'' version of sum. 
  \item $\Smid_{2p}(y) < 0$ as long as $\Smax_{2p}(z)< 0$..
  \end{itemize}
\end{frame}

\begin{frame}{Equilibrium Strategies}
  \it Theorem: The following strategy pair $(f^*,g^*)$ forms a Nash-equilibrium with $I(f^*,g^*) = (m-2p)C$:
  \begin{block}{Attack Strategy $g^*$: Flipping Attack}
    Flip $p$ compromised sensors' measurements.
  \end{block}
  \begin{block}{Detection Strategy $f^*$: Trimmed Mean}
    \begin{enumerate}
    \item For each sensor $i$, compute a local average $ \bar y_i(k) = \sum_{t=1}^k y_i(t)$.
    \item The detector $f_k$ is given by
      \begin{displaymath}
        f_k(Y(k)) = \begin{cases}
          -1 &\text{if }\Smid_{2p}(\bar y(k))< 0\\
          1 &\text{if }\Smid_{2p}(\bar y(k))\geq 0\\
        \end{cases}
      \end{displaymath}
    \end{enumerate}
  \end{block}
  $X_- = \left\{y:\Smax_{2p}(y) < 0\right\}$ and $X_+ = \left\{y:\Smin_{2p}(y) > 0\right\}$.


\end{frame}

\begin{frame}{What is the Cost of Security?}
  \begin{itemize}
  \item We need to consider the system performance both in the presence and in the absence of the attack.
    \vspace{0.5cm}
    \begin{center}
      \inputtikz{fun_lim2}
    \end{center}
  \item Unfortunately, trimmed sum has an efficiency of $(m-p)C$.
  \item How to get perfect security and efficiency simultaneously?
  \end{itemize}
\end{frame}

\begin{frame}{Cost-Free Security}
  \begin{enumerate}
  \item If there exists a set $J$ of $m-p$ sensors, such that
    \begin{align*}
      \sum_{i\in \mathcal J}\frac{1}{2}(\bar y_i+1)^2 < (m-2p)C,
    \end{align*}
    then choose $\hat \theta = 0$. 
  \item If there exists a set $J$ of $m-p$ sensors, such that
    \begin{align*}
      \sum_{i\in \mathcal J}\frac{1}{2}(\bar y_i-1)^2 < (m-2p)C,
    \end{align*}
    then choose $\hat \theta = 1$. 
  \item If none of the above conditions are satisfied, do a Naive Bayes test.
  \end{enumerate}
\end{frame}

\begin{frame}{Cost-Free Security}
  \begin{itemize}
  \item The best security $(m-2n)C$ and the best efficiency $mC$ are achieved simultaneously
  \item Security is ``cost-free''
    \begin{itemize}
    \item Computational burden: $O(m)$ versus $O(m\log m)$
    \end{itemize}
  \item Generalization: ``symmetric'' distributions. There exists a constant $a$ such that 
    \begin{align*}
      p_0(a+z) = p_1(a-z).
    \end{align*}
  \end{itemize}
\end{frame}

\begin{frame}{Generalization: Unknown Number of Compromised sensors}
  \begin{enumerate}
  \item Set $p = \lfloor m/2\rfloor -1$.
  \item 
    \begin{itemize}
    \item If there exists a set $J$ of $m-p$ sensors, such that
      \begin{align*}
        \sum_{i\in \mathcal J}\frac{1}{2}(\bar y_i+1)^2 < (m-2p)C,
      \end{align*}
      then choose $\hat \theta = 0$. 
    \item If there exists a set $J$ of $m-p$ sensors, such that
      \begin{align*}
        \sum_{i\in \mathcal J}\frac{1}{2}(\bar y_i-1)^2 < (m-2p)C,
      \end{align*}
      then choose $\hat \theta = 1$. 
    \end{itemize}
  \item Reduce $p$ by 1. If $p > 0$, go back to step 2, otherwise do a Naive Bayes test.
  \end{enumerate}
  The above algorithm is optimal for any number of compromised sensors.
\end{frame}

%\begin{frame}{General Case: Some Definitions from Large Deviation Theory}
%  \begin{center}
%    \inputtikz{rate_function}
%  \end{center}
%  \begin{itemize}
%  \item $I_\theta(y) \triangleq \sup_{w} yw - \log \mathbb E_\theta exp(\lambda w).$
%  \item $I_\theta(y)$ measures how typical a measurement $y$ is under each hypothesis.
%  \end{itemize}
%\end{frame}

\begin{frame}{General Cases}
  \begin{center}
    \inputtikz{fun_lim}
  \end{center}
  Fundamental Trade-off:
  \begin{align*}
I_0^{-1}\left(\frac{s}{m-n}\right)\leq I_1^{-1}\left(\frac{e}{m-n}\right),\, I_0^{-1}\left(\frac{e}{m-n}\right)\leq I_1^{-1}\left(\frac{s}{m-n}\right). 
  \end{align*}
  For the Gaussian case, the blue and red line will not cut the corner.
\end{frame}

\begin{frame}{General Case}
  The following detection strategy achieves the fundamental limit\footnote{Xiaoqiang Ren, Jiaqi Yan and Yilin Mo, Binary Hypothesis Testing with Byzantine Sensors: Fundamental Trade-off Between Security and Efficiency, IEEE Transactions on Signal Processing, Mar 2018, Volume 66, Issue 6, Pages 1454-1468 }:
  \begin{enumerate}
  \item If there exists a set $J$ of $m-p$ sensors, such that
    \begin{align*}
      \sum_{i\in \mathcal J}I_0(\bar \lambda_i) < threshold,
    \end{align*}
    then choose $\hat \theta = 0$. 
  \item If there exists a set $J$ of $m-p$ sensors, such that
    \begin{align*}
      \sum_{i\in \mathcal J}I_1(\bar \lambda_i) < threshold,
    \end{align*}
    then choose $\hat \theta = 1$. 
  \item If none of the above conditions are satisfied, do a Naive Bayes test.
  \end{enumerate}
\end{frame}

\begin{frame}{Simulation}
  Assuming the following distribution:
  \begin{center}
    \begin{tabular}{@{}llr@{}}
      \toprule
      & $z = 0$ & $z=1$\\
      \midrule
      $\theta=0$ &0.98&0.02\\
      $\theta=1$ &0.4&0.6\\
      \bottomrule
    \end{tabular}
  \end{center}  
  We choose the detector with perfect efficiency:
  \begin{center}
    \inputtikz{finite_time}
  \end{center}
\end{frame}

\begin{frame}{Sequential Hypothesis Testing}
  
  \begin{center}
    \begin{tikzpicture}

      \begin{axis}[
	width=3in,
	height=1.7in,
	scale only axis,
	ylabel={likelihood ratio},
	]
	\addplot[color=red,dashed]
	  coordinates{
	    (1.0, 100.0)
	    (1000.0, 100.0)
	  };

	\addplot[color=red,dashed]
	  coordinates{
	    (1.0, -100.0)
	    (1000.0, -100.0)
	  };
	\addplot[color=blue] coordinates {
	    (1.0, 0.0)
	    (2.0, -0.1594002053100572)
	    (3.0, 0.17716919130222217)
	    (4.0, 0.29404369833227484)
	    (5.0, -0.7863437816479296)
	    (6.0, -0.6953042058410993)
	    (7.0, 0.022490752307200768)
	    (8.0, -0.9850203647973522)
	    (9.0, -0.9176172097205362)
	    (10.0, -1.3444984399467255)
	    (11.0, -0.21391235396145358)
	    (12.0, -1.1267895483442398)
	    (13.0, -1.065616036330525)
	    (14.0, -0.012625334484197337)
	    (15.0, 1.3201989100764235)
	    (16.0, 0.6510121922516093)
	    (17.0, 0.7960884135628494)
	    (18.0, 1.0757482132569423)
	    (19.0, 0.6181055299043391)
	    (20.0, -0.024062123859495244)
	    (21.0, -0.024247668381338017)
	    (22.0, -0.8663372403628407)
	    (23.0, -2.20541449551645)
	    (24.0, -1.0378103326610648)
	    (25.0, -1.1630005698456178)
	    (26.0, -1.6459962663025465)
	    (27.0, -3.0900893537084575)
	    (28.0, -3.3750217653307115)
	    (29.0, -5.424278884285342)
	    (30.0, -4.537409523377284)
	    (31.0, -3.5595493332486425)
	    (32.0, -4.142963672648382)
	    (33.0, -5.373737345659489)
	    (34.0, -6.61921974140331)
	    (35.0, -6.6580340386405235)
	    (36.0, -6.568582544525349)
	    (37.0, -6.6395886256637775)
	    (38.0, -5.228327053712468)
	    (39.0, -3.7022191489042675)
	    (40.0, -3.58860331627365)
	    (41.0, -5.389660871886582)
	    (42.0, -5.667665819324621)
	    (43.0, -5.28423492531854)
	    (44.0, -4.648256938632084)
	    (45.0, -5.048888840919144)
	    (46.0, -7.251535613772228)
	    (47.0, -8.773971374642525)
	    (48.0, -10.623636441461962)
	    (49.0, -11.261005474111002)
	    (50.0, -11.21091077561997)
	    (51.0, -13.487785904591858)
	    (52.0, -13.20775738016848)
	    (53.0, -13.495835934344036)
	    (54.0, -11.478515200988388)
	    (55.0, -10.994968842944209)
	    (56.0, -10.258761110215092)
	    (57.0, -9.857725384557334)
	    (58.0, -9.058875903644957)
	    (59.0, -7.706417290703628)
	    (60.0, -7.867413059255188)
	    (61.0, -8.114775413284962)
	    (62.0, -8.501594985263914)
	    (63.0, -8.447480336201696)
	    (64.0, -9.56877776051828)
	    (65.0, -10.855544606400883)
	    (66.0, -8.592776950360811)
	    (67.0, -7.6914517415352215)
	    (68.0, -7.819299512631095)
	    (69.0, -6.694168526171628)
	    (70.0, -6.0484926135347035)
	    (71.0, -4.017028319402085)
	    (72.0, -3.199955482159253)
	    (73.0, -2.323039527681359)
	    (74.0, -1.4444258728627166)
	    (75.0, -2.827789554549056)
	    (76.0, -2.5569281221569846)
	    (77.0, -2.1168864736075865)
	    (78.0, -1.4492125270683918)
	    (79.0, -2.0956320254500276)
	    (80.0, -2.2989499412523373)
	    (81.0, -2.0707359107440713)
	    (82.0, -2.033805864151017)
	    (83.0, -0.3105486617733739)
	    (84.0, -1.5436690669305506)
	    (85.0, 1.3635811772783673)
	    (86.0, 0.8138689681104139)
	    (87.0, -1.3517375042977733)
	    (88.0, -2.9266012660860197)
	    (89.0, -3.6128909218860055)
	    (90.0, -4.473766298390632)
	    (91.0, -5.243429737464443)
	    (92.0, -5.314218925651144)
	    (93.0, -5.861362032701184)
	    (94.0, -5.956932496013719)
	    (95.0, -7.5355325371326005)
	    (96.0, -6.823723607775973)
	    (97.0, -6.6409658256954955)
	    (98.0, -7.395496682879306)
	    (99.0, -5.934628078189998)
	    (100.0, -5.4180569682375355)
	    (101.0, -5.465039434876293)
	    (102.0, -5.981238032188201)
	    (103.0, -6.253029559601296)
	    (104.0, -6.310992865182354)
	    (105.0, -3.7269198099077885)
	    (106.0, -4.25201591974138)
	    (107.0, -5.4049486927659265)
	    (108.0, -5.083933503156594)
	    (109.0, -5.25337160940165)
	    (110.0, -5.621202389024207)
	    (111.0, -6.030856106095652)
	    (112.0, -5.404023743374493)
	    (113.0, -4.219226777424302)
	    (114.0, -3.1777800721722924)
	    (115.0, -3.4492053180854514)
	    (116.0, -3.405525456051597)
	    (117.0, -3.774241227299819)
	    (118.0, -4.429454436545873)
	    (119.0, -4.968797843318393)
	    (120.0, -4.942065095946338)
	    (121.0, -5.275946970816462)
	    (122.0, -5.766318555780817)
	    (123.0, -6.15751239631719)
	    (124.0, -6.2834269804925)
	    (125.0, -5.804794806479316)
	    (126.0, -6.563658086674642)
	    (127.0, -5.495936186118598)
	    (128.0, -3.716851933630588)
	    (129.0, -3.6945229143223988)
	    (130.0, -3.4029183851712244)
	    (131.0, -5.351040217771667)
	    (132.0, -6.172573960288358)
	    (133.0, -6.121084762614973)
	    (134.0, -5.887939829246384)
	    (135.0, -5.324837348623015)
	    (136.0, -4.663745330721508)
	    (137.0, -4.479718235666256)
	    (138.0, -4.513663605253228)
	    (139.0, -4.561535254278344)
	    (140.0, -4.028602319510775)
	    (141.0, -3.1171519455892196)
	    (142.0, -2.7353631300304873)
	    (143.0, -3.09975384758575)
	    (144.0, -2.9794113517561502)
	    (145.0, -2.3389332715287527)
	    (146.0, -2.7196362555610505)
	    (147.0, -2.9505202809300264)
	    (148.0, -3.4173653893646776)
	    (149.0, -2.5760138427430457)
	    (150.0, -2.811347244775121)
	    (151.0, -2.257301869543647)
	    (152.0, -1.3026070696955676)
	    (153.0, -0.46586816934211783)
	    (154.0, 1.004588242110605)
	    (155.0, 0.9463988215928494)
	    (156.0, 1.9111783235019204)
	    (157.0, 2.360410271258084)
	    (158.0, 2.7141903859730867)
	    (159.0, 3.7692964640412043)
	    (160.0, 3.572983567190011)
	    (161.0, 5.166699757072125)
	    (162.0, 5.23797228207044)
	    (163.0, 5.572390931347256)
	    (164.0, 5.571824157601236)
	    (165.0, 5.773576674808585)
	    (166.0, 7.100176486579381)
	    (167.0, 6.287240935835096)
	    (168.0, 6.678225069659426)
	    (169.0, 5.438114132570824)
	    (170.0, 5.947106609504127)
	    (171.0, 6.650162665876099)
	    (172.0, 5.438242168668441)
	    (173.0, 4.762653391922434)
	    (174.0, 5.093313602846328)
	    (175.0, 4.80766116502047)
	    (176.0, 5.554101680891628)
	    (177.0, 5.995446705904486)
	    (178.0, 5.712890114846204)
	    (179.0, 5.586786591154129)
	    (180.0, 6.6321788480618356)
	    (181.0, 7.541405321900588)
	    (182.0, 7.290758960688353)
	    (183.0, 8.582778833883578)
	    (184.0, 9.638915219453411)
	    (185.0, 9.251464125750683)
	    (186.0, 10.281253632037384)
	    (187.0, 12.390599588778919)
	    (188.0, 13.635431911962073)
	    (189.0, 13.202766763844805)
	    (190.0, 12.866319276621537)
	    (191.0, 14.561481535259116)
	    (192.0, 14.78381317532585)
	    (193.0, 15.730757601183067)
	    (194.0, 15.625125394669276)
	    (195.0, 15.421821154545121)
	    (196.0, 16.573882548886107)
	    (197.0, 17.466712823332813)
	    (198.0, 17.46172484076808)
	    (199.0, 18.994448600540984)
	    (200.0, 19.883782574752335)
	    (201.0, 19.890919915552573)
	    (202.0, 20.284980675148653)
	    (203.0, 19.21717261699249)
	    (204.0, 18.775343311767685)
	    (205.0, 20.29466354890412)
	    (206.0, 18.965239266712654)
	    (207.0, 18.220870485809947)
	    (208.0, 19.135743893027776)
	    (209.0, 19.36176326813351)
	    (210.0, 19.38799807742395)
	    (211.0, 21.16139401928844)
	    (212.0, 22.223569262543254)
	    (213.0, 20.72067794743346)
	    (214.0, 20.542957232211048)
	    (215.0, 21.952000950960066)
	    (216.0, 21.76708250077007)
	    (217.0, 22.39343495094751)
	    (218.0, 21.750863752302138)
	    (219.0, 19.955861999158927)
	    (220.0, 18.413835395950493)
	    (221.0, 19.647711371365187)
	    (222.0, 19.934774788678485)
	    (223.0, 21.360327672581423)
	    (224.0, 22.10981922050097)
	    (225.0, 21.151464460168174)
	    (226.0, 21.67912261334479)
	    (227.0, 21.587219093297893)
	    (228.0, 22.082270361221536)
	    (229.0, 21.205011908240778)
	    (230.0, 20.677284133316334)
	    (231.0, 21.109477483042426)
	    (232.0, 21.840809655973064)
	    (233.0, 21.60050297613694)
	    (234.0, 22.606601489809183)
	    (235.0, 23.49448553000615)
	    (236.0, 24.15873070351103)
	    (237.0, 24.979995612404554)
	    (238.0, 25.53494671052848)
	    (239.0, 22.91837934212202)
	    (240.0, 21.82637597743732)
	    (241.0, 20.46470494470313)
	    (242.0, 22.33899442652614)
	    (243.0, 22.625476621650684)
	    (244.0, 22.124196954612817)
	    (245.0, 23.82586864455474)
	    (246.0, 23.811944189112076)
	    (247.0, 22.933446284790797)
	    (248.0, 24.863490047331826)
	    (249.0, 25.204871298945196)
	    (250.0, 25.816412942978882)
	    (251.0, 25.4355021313176)
	    (252.0, 25.506682235770654)
	    (253.0, 25.86752676156443)
	    (254.0, 26.00654863552568)
	    (255.0, 24.830778166048724)
	    (256.0, 25.67375955511013)
	    (257.0, 27.192269072523942)
	    (258.0, 26.85686071940937)
	    (259.0, 25.853971314377173)
	    (260.0, 25.103292466389306)
	    (261.0, 24.935259880991563)
	    (262.0, 25.672680097641884)
	    (263.0, 27.305310729162255)
	    (264.0, 28.210319879023587)
	    (265.0, 30.376280668546045)
	    (266.0, 30.895813536212753)
	    (267.0, 30.65838435664757)
	    (268.0, 30.72180072797467)
	    (269.0, 33.28463766159997)
	    (270.0, 33.292941847763196)
	    (271.0, 31.97010601269437)
	    (272.0, 35.79112607819205)
	    (273.0, 35.16447433806779)
	    (274.0, 34.94871664997165)
	    (275.0, 34.872979200350414)
	    (276.0, 35.7449512157193)
	    (277.0, 33.78370359488316)
	    (278.0, 34.687632098741624)
	    (279.0, 34.677940763604106)
	    (280.0, 34.748660768257565)
	    (281.0, 36.527501646293075)
	    (282.0, 35.99501483260221)
	    (283.0, 35.19429491603918)
	    (284.0, 37.12060500644678)
	    (285.0, 37.769098654971025)
	    (286.0, 36.87969821794534)
	    (287.0, 35.62550340747618)
	    (288.0, 35.90545937956123)
	    (289.0, 37.05405481192994)
	    (290.0, 37.48127923875844)
	    (291.0, 36.24792299009831)
	    (292.0, 37.65603467115882)
	    (293.0, 37.97372569871772)
	    (294.0, 40.47578659314596)
	    (295.0, 39.7918554845245)
	    (296.0, 39.96228127068353)
	    (297.0, 41.24679869244646)
	    (298.0, 40.79533439928725)
	    (299.0, 41.27821880147954)
	    (300.0, 41.718101457886235)
	    (301.0, 41.20671971295717)
	    (302.0, 41.17101530496034)
	    (303.0, 40.964336447372986)
	    (304.0, 40.5717589980181)
	    (305.0, 41.758113514312384)
	    (306.0, 41.268344446320356)
	    (307.0, 42.3992969165452)
	    (308.0, 42.90017489595159)
	    (309.0, 43.731682844527576)
	    (310.0, 44.20148991824966)
	    (311.0, 45.34076589875139)
	    (312.0, 46.590620465140574)
	    (313.0, 46.60530973730112)
	    (314.0, 45.852366394560754)
	    (315.0, 45.31489776558726)
	    (316.0, 46.26932486324496)
	    (317.0, 47.074315603241125)
	    (318.0, 48.63920151579966)
	    (319.0, 48.28849360081027)
	    (320.0, 49.40499756932885)
	    (321.0, 51.251705527021535)
	    (322.0, 50.97817718286761)
	    (323.0, 50.31423924446179)
	    (324.0, 50.811340457726374)
	    (325.0, 50.30926016331897)
	    (326.0, 49.322472070533586)
	    (327.0, 49.57169471673277)
	    (328.0, 50.16646167308755)
	    (329.0, 51.909617804435904)
	    (330.0, 51.96921556383022)
	    (331.0, 51.34515191244349)
	    (332.0, 50.63610856077912)
	    (333.0, 51.57371378252008)
	    (334.0, 51.73296428690278)
	    (335.0, 51.72787677585133)
	    (336.0, 50.505003812963665)
	    (337.0, 51.33625539077888)
	    (338.0, 51.32243026975186)
	    (339.0, 51.47493496461777)
	    (340.0, 52.244174997988935)
	    (341.0, 51.1045622849311)
	    (342.0, 53.08514746752267)
	    (343.0, 53.29717612629469)
	    (344.0, 54.539773024315664)
	    (345.0, 53.764984875711825)
	    (346.0, 54.13686683054419)
	    (347.0, 55.42114047110208)
	    (348.0, 57.436801964228245)
	    (349.0, 56.863648994240556)
	    (350.0, 57.148170389614585)
	    (351.0, 57.84281802575501)
	    (352.0, 57.60503362468464)
	    (353.0, 56.55720155094582)
	    (354.0, 56.66307684419409)
	    (355.0, 56.61884396809838)
	    (356.0, 58.26283446040028)
	    (357.0, 58.91415596610855)
	    (358.0, 58.84760840320332)
	    (359.0, 58.02447174046033)
	    (360.0, 58.88886860491189)
	    (361.0, 60.03811371038008)
	    (362.0, 59.67845485179356)
	    (363.0, 60.10295186027525)
	    (364.0, 59.591836035094616)
	    (365.0, 61.070025532309934)
	    (366.0, 60.98684081511546)
	    (367.0, 62.650737539289764)
	    (368.0, 61.12252195274564)
	    (369.0, 62.20511935700585)
	    (370.0, 62.10333447762423)
	    (371.0, 61.175169388922)
	    (372.0, 58.98324233510078)
	    (373.0, 58.71943681086796)
	    (374.0, 59.509054893756804)
	    (375.0, 59.82548770824624)
	    (376.0, 60.632450138480166)
	    (377.0, 63.04851793353984)
	    (378.0, 62.58628747318702)
	    (379.0, 62.29856735791711)
	    (380.0, 62.19466125363635)
	    (381.0, 62.85938527240018)
	    (382.0, 63.54703727254571)
	    (383.0, 63.79205052851641)
	    (384.0, 63.28565991249971)
	    (385.0, 64.66023621424736)
	    (386.0, 65.11367548985066)
	    (387.0, 66.72944426426776)
	    (388.0, 65.42840519171381)
	    (389.0, 66.15485309805531)
	    (390.0, 64.77954596315496)
	    (391.0, 64.40566566096648)
	    (392.0, 63.95733071154834)
	    (393.0, 64.21717855391752)
	    (394.0, 66.67484397773201)
	    (395.0, 66.9272190222456)
	    (396.0, 66.67677701410244)
	    (397.0, 67.4060213643075)
	    (398.0, 66.11016291533382)
	    (399.0, 66.43855312427779)
	    (400.0, 67.27823623489094)
	    (401.0, 67.21752415657232)
	    (402.0, 67.51572783484268)
	    (403.0, 67.46220065088113)
	    (404.0, 66.91973793848949)
	    (405.0, 68.32075952607998)
	    (406.0, 67.28298340964857)
	    (407.0, 67.39859289333818)
	    (408.0, 67.49314085884086)
	    (409.0, 66.69870912243218)
	    (410.0, 68.15202612906045)
	    (411.0, 68.03471373729444)
	    (412.0, 67.67659998268968)
	    (413.0, 67.85984690053571)
	    (414.0, 68.47467393559576)
	    (415.0, 68.3274733134281)
	    (416.0, 68.45826694136046)
	    (417.0, 68.5193156921643)
	    (418.0, 69.95160594233045)
	    (419.0, 69.88821822949645)
	    (420.0, 70.53092901714)
	    (421.0, 71.39414114584693)
	    (422.0, 72.56970308422869)
	    (423.0, 73.41474704972342)
	    (424.0, 73.04968685665708)
	    (425.0, 72.06306943522367)
	    (426.0, 73.00120889019001)
	    (427.0, 73.70756987714798)
	    (428.0, 73.44431268305848)
	    (429.0, 72.56530365127716)
	    (430.0, 70.56146918464505)
	    (431.0, 69.77577156351742)
	    (432.0, 71.22443473768963)
	    (433.0, 68.62943179149397)
	    (434.0, 68.14353738395394)
	    (435.0, 67.52330871396832)
	    (436.0, 67.06135692572283)
	    (437.0, 66.67644006440295)
	    (438.0, 67.54723625082926)
	    (439.0, 65.97008772838213)
	    (440.0, 66.83014669068592)
	    (441.0, 65.59646430673999)
	    (442.0, 65.43512639249666)
	    (443.0, 64.67893369446872)
	    (444.0, 63.08767803391775)
	    (445.0, 63.35758677904175)
	    (446.0, 64.29141454048361)
	    (447.0, 64.20624588235619)
	    (448.0, 64.16077801383034)
	    (449.0, 64.8347321653849)
	    (450.0, 64.64983090890702)
	    (451.0, 64.88080712981402)
	    (452.0, 64.34499683141641)
	    (453.0, 64.27435236378287)
	    (454.0, 64.43024694110164)
	    (455.0, 63.455459362497315)
	    (456.0, 63.231273278342876)
	    (457.0, 62.6345881254789)
	    (458.0, 63.996583606123906)
	    (459.0, 65.08944648490163)
	    (460.0, 66.22200058123735)
	    (461.0, 66.11628123868888)
	    (462.0, 67.84207755798163)
	    (463.0, 70.09951459188665)
	    (464.0, 71.10738012589974)
	    (465.0, 71.4467140713271)
	    (466.0, 70.40359184166171)
	    (467.0, 71.57768671053704)
	    (468.0, 70.62830960941946)
	    (469.0, 70.64059036294137)
	    (470.0, 70.10543081952325)
	    (471.0, 68.38147454328535)
	    (472.0, 67.73224501200968)
	    (473.0, 68.48198540197394)
	    (474.0, 68.4187398176778)
	    (475.0, 68.39282221133863)
	    (476.0, 67.99761788219642)
	    (477.0, 68.6781359881357)
	    (478.0, 69.61321118477862)
	    (479.0, 70.55705062297501)
	    (480.0, 71.99866836082761)
	    (481.0, 70.58203224149378)
	    (482.0, 68.72449130798043)
	    (483.0, 70.23710894256592)
	    (484.0, 69.72518399228635)
	    (485.0, 69.77180180365731)
	    (486.0, 68.69078177104952)
	    (487.0, 68.58213611986305)
	    (488.0, 70.40726589063652)
	    (489.0, 69.86559910924429)
	    (490.0, 69.75334300598588)
	    (491.0, 69.01855306908264)
	    (492.0, 70.46344153201873)
	    (493.0, 71.57138920131479)
	    (494.0, 71.54183237350593)
	    (495.0, 72.20761892093522)
	    (496.0, 71.3373200271395)
	    (497.0, 71.60498297008174)
	    (498.0, 69.96943270680508)
	    (499.0, 71.23938435404996)
	    (500.0, 71.6633266518628)
	    (501.0, 70.92838207182871)
	    (502.0, 69.23446211235786)
	    (503.0, 70.48142360746928)
	    (504.0, 70.96862535690563)
	    (505.0, 71.58012871175053)
	    (506.0, 72.60351725145532)
	    (507.0, 73.43833794010118)
	    (508.0, 73.66411261231544)
	    (509.0, 74.62517149685637)
	    (510.0, 73.16278244970489)
	    (511.0, 73.11671424858298)
	    (512.0, 73.40073488663958)
	    (513.0, 75.61085554793165)
	    (514.0, 76.26171624229646)
	    (515.0, 77.17226749529887)
	    (516.0, 76.59861940860326)
	    (517.0, 76.52505285127458)
	    (518.0, 76.82494076176721)
	    (519.0, 77.69110824677229)
	    (520.0, 77.17158713692145)
	    (521.0, 76.47607485864332)
	    (522.0, 76.85833728799656)
	    (523.0, 77.3331122244269)
	    (524.0, 76.60431313472458)
	    (525.0, 76.55116577855576)
	    (526.0, 76.91566021073348)
	    (527.0, 77.04085273069474)
	    (528.0, 77.21853831011076)
	    (529.0, 77.63996851369568)
	    (530.0, 77.08774349606766)
	    (531.0, 76.423259154245)
	    (532.0, 75.29702293201268)
	    (533.0, 75.69028489454188)
	    (534.0, 73.6869448817165)
	    (535.0, 75.35132252550794)
	    (536.0, 75.80636365321479)
	    (537.0, 77.19455706672476)
	    (538.0, 76.89839745614196)
	    (539.0, 75.54923784985714)
	    (540.0, 74.60457167795262)
	    (541.0, 75.92264254686552)
	    (542.0, 77.21862396730704)
	    (543.0, 75.47607867515475)
	    (544.0, 74.94138062641359)
	    (545.0, 76.22660333401276)
	    (546.0, 76.16161076303669)
	    (547.0, 77.07121086389604)
	    (548.0, 76.39789051743288)
	    (549.0, 76.17725859224184)
	    (550.0, 76.21476323817886)
	    (551.0, 76.3293410756119)
	    (552.0, 75.83856389597791)
	    (553.0, 77.9961366295554)
	    (554.0, 78.27238587188266)
	    (555.0, 77.73243916172177)
	    (556.0, 78.33308179859475)
	    (557.0, 77.5012397823599)
	    (558.0, 77.47551475786403)
	    (559.0, 77.16294619433172)
	    (560.0, 78.2643127085999)
	    (561.0, 78.63030306515432)
	    (562.0, 76.61948487282213)
	    (563.0, 75.85564360755065)
	    (564.0, 77.213579170971)
	    (565.0, 77.34899595060286)
	    (566.0, 75.57972974653806)
	    (567.0, 76.63745348761158)
	    (568.0, 76.70501578670799)
	    (569.0, 76.91256726941936)
	    (570.0, 76.3913780723739)
	    (571.0, 75.29582736310363)
	    (572.0, 75.3053148168425)
	    (573.0, 75.9757575022526)
	    (574.0, 76.40581997032487)
	    (575.0, 76.3789760793979)
	    (576.0, 76.6069038739416)
	    (577.0, 76.80649952329472)
	    (578.0, 75.29982617806019)
	    (579.0, 76.20158844504253)
	    (580.0, 76.04125145733275)
	    (581.0, 75.97213310748465)
	    (582.0, 75.77721244431656)
	    (583.0, 74.26612106206859)
	    (584.0, 74.49206896382518)
	    (585.0, 74.79694316500874)
	    (586.0, 74.66886357398685)
	    (587.0, 73.24629604948471)
	    (588.0, 73.76812161759098)
	    (589.0, 73.47124293359163)
	    (590.0, 74.57090424636057)
	    (591.0, 74.47574536957306)
	    (592.0, 71.4698698767187)
	    (593.0, 72.02280235184575)
	    (594.0, 73.29346665399912)
	    (595.0, 72.63965651008498)
	    (596.0, 73.82445796687638)
	    (597.0, 72.84517485478902)
	    (598.0, 72.05078883528874)
	    (599.0, 72.51226121115857)
	    (600.0, 73.95733380582116)
	    (601.0, 75.18428195569886)
	    (602.0, 73.25321119719781)
	    (603.0, 74.16933645575212)
	    (604.0, 73.25420581171139)
	    (605.0, 71.90101605506625)
	    (606.0, 71.53792469919183)
	    (607.0, 70.52928947541811)
	    (608.0, 70.34890503594808)
	    (609.0, 71.26643679949805)
	    (610.0, 71.77751047100631)
	    (611.0, 70.79444756922854)
	    (612.0, 70.56677778094586)
	    (613.0, 69.95443413685246)
	    (614.0, 68.90083690830643)
	    (615.0, 67.80212310593731)
	    (616.0, 66.74354137073007)
	    (617.0, 67.9595521562332)
	    (618.0, 67.0254990454065)
	    (619.0, 65.69057423803473)
	    (620.0, 68.49933265226126)
	    (621.0, 69.700806760685)
	    (622.0, 70.93564212706335)
	    (623.0, 71.06703070467071)
	    (624.0, 72.05616251429747)
	    (625.0, 71.92746424362682)
	    (626.0, 70.91519319267142)
	    (627.0, 69.58574378180793)
	    (628.0, 68.62906024880328)
	    (629.0, 67.16404798655427)
	    (630.0, 68.31100289764139)
	    (631.0, 68.22692678712257)
	    (632.0, 68.55072497701423)
	    (633.0, 69.37121941818016)
	    (634.0, 69.5199236271828)
	    (635.0, 69.02431366618373)
	    (636.0, 67.86833446866557)
	    (637.0, 68.65232844732101)
	    (638.0, 69.6266230450987)
	    (639.0, 71.39558723184926)
	    (640.0, 73.4306057342274)
	    (641.0, 74.22972283823647)
	    (642.0, 74.82723396382332)
	    (643.0, 75.68299708123921)
	    (644.0, 75.80918848309338)
	    (645.0, 77.07973479525322)
	    (646.0, 78.36647541537265)
	    (647.0, 77.7844076433975)
	    (648.0, 78.05889699219121)
	    (649.0, 76.81764054468738)
	    (650.0, 75.52527305550592)
	    (651.0, 74.92096027007614)
	    (652.0, 74.97584208641474)
	    (653.0, 74.87660877470499)
	    (654.0, 75.46050635711491)
	    (655.0, 76.32474290071958)
	    (656.0, 76.90053859549896)
	    (657.0, 76.00423715744788)
	    (658.0, 77.49905400521172)
	    (659.0, 77.03661786607157)
	    (660.0, 75.48089877567713)
	    (661.0, 76.57521858136184)
	    (662.0, 76.73629152864538)
	    (663.0, 76.04243226732505)
	    (664.0, 74.89149199436413)
	    (665.0, 74.09550326774384)
	    (666.0, 74.1311995608614)
	    (667.0, 75.00668916083562)
	    (668.0, 74.00000466996588)
	    (669.0, 73.59980717608778)
	    (670.0, 74.25820064193637)
	    (671.0, 74.0154555630147)
	    (672.0, 74.92509307344162)
	    (673.0, 75.31994226453553)
	    (674.0, 75.75716488203437)
	    (675.0, 76.96933093459552)
	    (676.0, 75.43839608609987)
	    (677.0, 75.3446318522549)
	    (678.0, 74.90031257419788)
	    (679.0, 73.78530627355171)
	    (680.0, 74.07009597259422)
	    (681.0, 73.42836779639812)
	    (682.0, 74.42917998344625)
	    (683.0, 74.66247801555133)
	    (684.0, 75.68193119960915)
	    (685.0, 76.32047002825091)
	    (686.0, 78.05795569397046)
	    (687.0, 78.69509923873683)
	    (688.0, 79.05208531667226)
	    (689.0, 79.65653802599387)
	    (690.0, 79.24154139595004)
	    (691.0, 80.47675590525732)
	    (692.0, 80.0837076375748)
	    (693.0, 79.14703782501878)
	    (694.0, 79.48845181303805)
	    (695.0, 78.87999483724825)
	    (696.0, 77.4161619134773)
	    (697.0, 78.39173586734923)
	    (698.0, 78.19732263219169)
	    (699.0, 79.66594519881797)
	    (700.0, 80.6205135851275)
	    (701.0, 79.83193544280984)
	    (702.0, 78.92912505134991)
	    (703.0, 78.11199574210666)
	    (704.0, 77.98958756254882)
	    (705.0, 78.69074174969136)
	    (706.0, 77.73313393478406)
	    (707.0, 78.75489505570472)
	    (708.0, 77.30937548569166)
	    (709.0, 75.21079126721017)
	    (710.0, 75.38208277316559)
	    (711.0, 74.29645178404951)
	    (712.0, 74.29556460803332)
	    (713.0, 73.96123964409482)
	    (714.0, 73.47242499132079)
	    (715.0, 72.21054098679942)
	    (716.0, 72.75432191043836)
	    (717.0, 73.0246330926429)
	    (718.0, 74.00795142060744)
	    (719.0, 74.08664269095655)
	    (720.0, 72.83036789291812)
	    (721.0, 72.77964215097553)
	    (722.0, 72.1547701813971)
	    (723.0, 72.12776788438521)
	    (724.0, 72.78733635794839)
	    (725.0, 71.37162917202686)
	    (726.0, 69.35733528008862)
	    (727.0, 69.33063468383904)
	    (728.0, 68.54440844806201)
	    (729.0, 68.86877969248368)
	    (730.0, 67.08127141332764)
	    (731.0, 65.5483676265112)
	    (732.0, 65.29330108878209)
	    (733.0, 64.48827286883399)
	    (734.0, 62.39960888742568)
	    (735.0, 65.16199204569392)
	    (736.0, 65.69129398911012)
	    (737.0, 68.3580578533944)
	    (738.0, 67.78437248267109)
	    (739.0, 69.2831658472237)
	    (740.0, 68.3375983650115)
	    (741.0, 67.38710122388477)
	    (742.0, 68.35755850859881)
	    (743.0, 67.10736329387335)
	    (744.0, 67.16952911262992)
	    (745.0, 66.30196479226645)
	    (746.0, 66.33988451842882)
	    (747.0, 65.295562293927)
	    (748.0, 65.04060573608734)
	    (749.0, 65.83203589460982)
	    (750.0, 65.57171562480568)
	    (751.0, 65.11092564511958)
	    (752.0, 64.69396032900869)
	    (753.0, 65.62209361493717)
	    (754.0, 65.87207022635346)
	    (755.0, 64.48543110830414)
	    (756.0, 65.02007911566271)
	    (757.0, 64.9425890336736)
	    (758.0, 64.86025338214692)
	    (759.0, 66.32179785829716)
	    (760.0, 66.60566210288754)
	    (761.0, 67.10909223483353)
	    (762.0, 67.28946612327498)
	    (763.0, 66.64289193526344)
	    (764.0, 67.72885245171017)
	    (765.0, 66.99760367101713)
	    (766.0, 67.11076523741414)
	    (767.0, 67.73988557407581)
	    (768.0, 67.59666695964556)
	    (769.0, 66.66960915790433)
	    (770.0, 66.53986282294956)
	    (771.0, 66.60680662520153)
	    (772.0, 64.55344630604239)
	    (773.0, 66.10619019607768)
	    (774.0, 64.99807115222605)
	    (775.0, 65.68022259379217)
	    (776.0, 64.93543070998051)
	    (777.0, 64.84618693322118)
	    (778.0, 64.39096548177588)
	    (779.0, 65.17888350149656)
	    (780.0, 68.56569203559698)
	    (781.0, 67.3691141573569)
	    (782.0, 69.23601681549725)
	    (783.0, 67.79240648196063)
	    (784.0, 66.86502054359731)
	    (785.0, 66.80980191329715)
	    (786.0, 68.95737661262072)
	    (787.0, 70.03213537400303)
	    (788.0, 70.51382265927997)
	    (789.0, 71.51983754661723)
	    (790.0, 72.19861287587236)
	    (791.0, 74.36473931027561)
	    (792.0, 73.61331373038479)
	    (793.0, 74.04120648320398)
	    (794.0, 74.56609951074772)
	    (795.0, 74.25803990327239)
	    (796.0, 74.19025896139962)
	    (797.0, 75.65519117576838)
	    (798.0, 75.37057685210144)
	    (799.0, 76.58705745741278)
	    (800.0, 77.94503508067871)
	    (801.0, 78.26194507808937)
	    (802.0, 80.10916404952278)
	    (803.0, 80.23565821556811)
	    (804.0, 79.50031638437336)
	    (805.0, 79.59988122542066)
	    (806.0, 79.75699825558206)
	    (807.0, 79.11416000529944)
	    (808.0, 77.64221959043815)
	    (809.0, 76.68065285545072)
	    (810.0, 77.30480411854708)
	    (811.0, 77.42658372063306)
	    (812.0, 78.68600716680503)
	    (813.0, 78.8614405028244)
	    (814.0, 79.50732373607963)
	    (815.0, 80.91720083976735)
	    (816.0, 79.08302310000711)
	    (817.0, 78.90381023892081)
	    (818.0, 78.57774850984752)
	    (819.0, 79.42386104263498)
	    (820.0, 80.58847133406222)
	    (821.0, 82.71344190463067)
	    (822.0, 83.00847550803456)
	    (823.0, 83.93238210108447)
	    (824.0, 83.64194462696786)
	    (825.0, 84.02061867865629)
	    (826.0, 84.25151853792313)
	    (827.0, 84.86898101514541)
	    (828.0, 86.20451743007975)
	    (829.0, 87.81046243122987)
	    (830.0, 87.0504125878602)
	    (831.0, 88.10340206756297)
	    (832.0, 86.97793614527814)
	    (833.0, 87.1162519597108)
	    (834.0, 86.8806605951737)
	    (835.0, 85.69139365512939)
	    (836.0, 85.14796160005555)
	    (837.0, 83.51603320325266)
	    (838.0, 83.62108613421769)
	    (839.0, 85.11353844846155)
	    (840.0, 84.68584989225435)
	    (841.0, 84.95533617062303)
	    (842.0, 84.64261521083824)
	    (843.0, 85.03000179481307)
	    (844.0, 85.26803676857344)
	    (845.0, 85.52894919142521)
	    (846.0, 85.68193507690869)
	    (847.0, 85.39956408058497)
	    (848.0, 84.13426592836959)
	    (849.0, 85.15328713499639)
	    (850.0, 87.98426542032584)
	    (851.0, 87.59115442305227)
	    (852.0, 88.09359704013387)
	    (853.0, 90.19363767549838)
	    (854.0, 91.053539321682)
	    (855.0, 91.2101052681308)
	    (856.0, 92.5440508831696)
	    (857.0, 93.59486676013609)
	    (858.0, 93.81065588429401)
	    (859.0, 94.1702179765871)
	    (860.0, 94.51775604056479)
	    (861.0, 95.24503520212001)
	    (862.0, 95.74290353942077)
	    (863.0, 94.25747445113939)
	    (864.0, 95.04312889720954)
	    (865.0, 94.9779502258697)
	    (866.0, 95.56127944552873)
	    (867.0, 95.26446556577602)
	    (868.0, 94.21036552963729)
	    (869.0, 94.59302450907023)
	    (870.0, 95.29885022885622)
	    (871.0, 95.73881892557682)
	    (872.0, 95.53866868176338)
	    (873.0, 95.67324091505952)
	    (874.0, 96.44353463588413)
	    (875.0, 97.29291284256055)
	    (876.0, 96.05050105268266)
	    (877.0, 95.77181950712907)
	    (878.0, 96.565866776626)
	    (879.0, 95.40985560842341)
	    (880.0, 96.04324787903937)
	    (881.0, 95.24497977738294)
	    (882.0, 95.66739290902285)
	    (883.0, 96.4347906105531)
	    (884.0, 95.98190450791157)
	    (885.0, 94.94017102000997)
	    (886.0, 95.53076550139083)
	    (887.0, 95.38383421178618)
	    (888.0, 96.36203034597972)
	    (889.0, 96.02303174875146)
	    (890.0, 96.18101697426852)
	    (891.0, 95.99249559477632)
	    (892.0, 96.58387684999599)
	    (893.0, 95.65537423377332)
	    (894.0, 98.19290421873599)
	    (895.0, 97.67582955356553)
	    (896.0, 98.27248179880634)
	    (897.0, 98.61200763103535)
	    (898.0, 99.23540328648191)
	    (899.0, 97.94925764451042)
	    (900.0, 97.96488807030916)
	    (901.0, 97.97073655530785)
	    (902.0, 98.8982012627537)
	    (903.0, 98.35435278360592)
	    (904.0, 97.84152314872942)
	    (905.0, 96.43485655000342)
	    (906.0, 94.18019998074307)
	    (907.0, 94.58724415527259)
	    (908.0, 97.1224322086127)
	    (909.0, 96.32681093465536)
	    (910.0, 95.5587615150422)
	    (911.0, 93.13016436409478)
	    (912.0, 93.93309767062767)
	    (913.0, 94.19374934202358)
	    (914.0, 92.7868238067962)
	    (915.0, 93.56689892565008)
	    (916.0, 92.71782097889067)
	    (917.0, 93.71269647938578)
	    (918.0, 94.11308095898696)
	    (919.0, 95.06113884598174)
	    (920.0, 93.82689494706524)
	    (921.0, 92.4564375642044)
	    (922.0, 92.92444614138059)
	    (923.0, 93.24029568943494)
	    (924.0, 93.2048841251498)
	    (925.0, 93.21428826714707)
	    (926.0, 94.830780507818)
	    (927.0, 94.1181834747403)
	    (928.0, 94.31044563482692)
	    (929.0, 96.45133079864775)
	    (930.0, 97.02851951471143)
	    (931.0, 97.14479366582596)
	    (932.0, 97.1760383436677)
	    (933.0, 98.41034866646072)
	    (934.0, 98.60930021297135)
	    (935.0, 99.5988252357054)
	    (936.0, 98.8260109535254)
	    (937.0, 99.65624662932555)
	    (938.0, 100.63972898101376)
	    (939.0, 101.78824453760208)
	    (940.0, 99.58893341750846)
	    (941.0, 99.08202856763825)
	    (942.0, 100.07005344681501)
	    (943.0, 101.44044381322172)
	    (944.0, 101.45409094054524)
	    (945.0, 102.76593143793814)
	    (946.0, 101.38127376039641)
	    (947.0, 101.81759768142251)
	    (948.0, 103.09738342484663)
	    (949.0, 102.48572613678849)
	    (950.0, 102.15227149648919)
	    (951.0, 101.76292038570742)
	    (952.0, 103.70941882688038)
	    (953.0, 103.8608260356168)
	    (954.0, 104.25773094352364)
	    (955.0, 104.02767806755323)
	    (956.0, 104.53170940965825)
	    (957.0, 106.57338361796984)
	    (958.0, 107.8704260966592)
	    (959.0, 106.30898940674224)
	    (960.0, 106.04192473346995)
	    (961.0, 105.13652320063058)
	    (962.0, 105.49878462071243)
	    (963.0, 105.35091959808676)
	    (964.0, 105.31388598732077)
	    (965.0, 106.14297911328484)
	    (966.0, 106.35708234668596)
	    (967.0, 105.24730499670112)
	    (968.0, 106.53542375820192)
	    (969.0, 107.46791172427228)
	    (970.0, 108.51578559269518)
	    (971.0, 108.25591624530384)
	    (972.0, 108.66015106815604)
	    (973.0, 110.28750736930317)
	    (974.0, 110.6628379070541)
	    (975.0, 112.23594534381611)
	    (976.0, 112.08693529795055)
	    (977.0, 109.35842249274356)
	    (978.0, 110.80985405687937)
	    (979.0, 111.09743931544381)
	    (980.0, 111.3504651933782)
	    (981.0, 111.00818645828961)
	    (982.0, 110.59480190684106)
	    (983.0, 109.22518280934399)
	    (984.0, 108.26489640951158)
	    (985.0, 106.95586150011972)
	    (986.0, 109.39835336384397)
	    (987.0, 109.20348212744639)
	    (988.0, 109.5609644890075)
	    (989.0, 109.7723032837849)
	    (990.0, 109.39086354877554)
	    (991.0, 108.7819445626197)
	    (992.0, 110.405740473842)
	    (993.0, 108.94116830789396)
	    (994.0, 108.84301160355669)
	    (995.0, 108.98208342249804)
	    (996.0, 109.30885094739826)
	    (997.0, 110.63303243072991)
	    (998.0, 111.76285679717478)
	    (999.0, 112.71777953464175)
	    (1000.0, 112.36086094574767)
	    (1001.0, 111.4232332182716)
	  };
	\end{axis}

      \end{tikzpicture}
    \end{center}
    Instead of deciding $\theta$ at a fixed time $t$, at every time, we can make 3 decisions:
    \begin{itemize}
      \item Decide $\theta = 0$;
      \item Decide $\theta = 1$; 
      \item Take another measurement.
    \end{itemize}
  \end{frame}

  \begin{frame}{Performance Metric}
    \begin{itemize}
      \item Similar to the previous case, we could define the rate function to be
	\begin{displaymath}
	  I = \liminf_{P_e\rightarrow 0} -\frac{\log P_e}{\mathbb E T},
	\end{displaymath}
	where $P_e$ is a pre-specified probability of error and $T$ is the time to achieve such error.
      \item  $I$ is a function of both detection strategy $f$ and attack strategy $g$.
      \item The detector wants to maximize $I$ while the attacker wants to minimize $I$.
	\begin{displaymath}
	  I(f^*,g)\geq I(f^*,g^*) \geq I(f,g^*).	
	\end{displaymath}
    \end{itemize}  
  \end{frame}

  \begin{frame}{Equilibrium Strategies}
    \emph{Theorem\footnote{Zishuo Li, Yilin Mo and Fei Hao, Game Theoretical Approach to Sequential Hypothesis Test with Byzantine Sensors, IEEE CDC 2019.}: The following strategy pair $(f^*,g^*)$ forms a Nash-equilibrium with $I(f^*,g^*) = (m-2p)\tilde C$:}
    \begin{block}{Attack Strategy $g^*$}
      Flip $p$ compromised sensors' measurements.
    \end{block}
    \begin{block}{Detection Strategy $f^*$ (Vote Counting)}
      \begin{enumerate}
	\item Each sensor has two triggers $t_{i,0}=0$ and $t_{i,1}=1$.
	\item If $\sum_{t=1}^k y_i(t) < -threshold$ at certain time $k$, set $t_{i,0} = 1$
	\item If $\sum_{t=1}^k y_i(t) > threshold$ at certain time $k$, set $t_{i,1} = 1$
	\item Make a decision $\hat \theta = 0$ if $\sum_i t_{i,0} \geq m-p$, or $\hat \theta = 1$ if $\sum_i t_{i,1} \geq m-p$.
      \end{enumerate}
    \end{block}

  \end{frame}

  \begin{frame}{Remarks}
    \begin{itemize}
      \item Only need to exchange at most $2m$ messages (regardless of $P_e$)
      \item Can be implemented as an event-based strategy.
      \item Potentially can be made into a distributed algorithm?
      \item Efficiency vs Security trade-off?
    \end{itemize}
\end{frame}

  \section{Conclusion and Future Works}

  \begin{frame}{Towards a Science of CPS Security}
    \begin{itemize}
      \item We consider the hypothesis testing problem in adversarial environment and propose secure and efficient algorithm for both problems.
      \item System theory can help us to design resilient CPS, which can tolerate malicious attacks.
      \item How to systematically design algorithms that are both secure and efficient?
    \end{itemize}
  \end{frame}

  \begin{frame}[standout]
    Thank you!
  \end{frame}

\end{document}
